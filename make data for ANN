def load_from_github(url):
    from urllib.request import urlopen
    from os import remove
    
    obj = urlopen(url)
    assert obj.getcode()==200,"unable to open"

    s = str(obj.read(), encoding="utf-8")
    NAME = "_temp.py"
    with open(NAME, mode='wt', encoding='utf-8') as fh: fh.write(s)
    module = __import__(NAME[:-3])
    remove(NAME)
    return module


url = r"https://raw.githubusercontent.com/leztien/synthetic_datasets/master/make_data_for_ANN.py"
module = load_from_github(url)
X,y = module.make_data_for_ANN(m=10000, n=2, K=5, L=3, u=16, gmm=True, balanced_classes=True, seed=True)

m,n = X.shape
import numpy as np
print("labels counts =", np.bincount(y))

from sklearn.neural_network import MLPClassifier
md = MLPClassifier((16,16,16))
md.fit(X,y)
acc = md.score(X,y)
print("sklearn MLP accuracy =", round(acc,2))

if n == 2:
    import matplotlib.pyplot as plt
    plt.scatter(*X.T, c=y, s=5, cmap='rainbow')
